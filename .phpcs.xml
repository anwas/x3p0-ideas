<?xml version="1.0"?>
<ruleset name="X3P0">
	<!-- Configure PHP version to test. -->
	<config name="testVersion" value="7.4-"/>

	<!-- Only check the PHP files. -->
	<arg name="extensions" value="php"/>

	<!-- Exclude files and folders. -->
	<exclude-pattern>*/(node_modules|public|vendor)/*</exclude-pattern>

	<!-- Check PHP compatibility. -->
	<rule ref="PHPCompatibilityWP">
		<include-pattern>*\.php$</include-pattern>
	</rule>

	<!-- Run against the WordPress Extra ruleset. -->
	<rule ref="WordPress-Extra">
		<!-- @todo Review these. -->
		<exclude name="Generic.CodeAnalysis.AssignmentInCondition"/>
		<exclude name="Generic.Functions.FunctionCallArgumentSpacing.TooMuchSpaceAfterComma"/>
		<exclude name="Generic.Classes.OpeningBraceSameLine"/>
		<exclude name="Generic.Functions.OpeningFunctionBraceKernighanRitchie"/>
		<exclude name="Generic.WhiteSpace.DisallowSpaceIndent"/>
		<exclude name="NormalizedArrays.Arrays.ArrayBraceSpacing.SpaceBeforeArrayCloserSingleLine"/>
		<exclude name="NormalizedArrays.Arrays.CommaAfterLast"/>
		<exclude name="PEAR.Functions.FunctionCallSignature"/>
		<exclude name="Squiz.PHP.DisallowMultipleAssignments.Found"/>
		<exclude name="Squiz.PHP.DisallowMultipleAssignments.FoundInControlStructure"/>
		<exclude name="Squiz.PHP.EmbeddedPhp.ContentAfterOpen"/>
		<exclude name="Squiz.PHP.EmbeddedPhp.ContentBeforeOpen"/>
		<exclude name="Universal.NamingConventions.NoReservedKeywordParameterNames"/>
		<exclude name="Universal.WhiteSpace.PrecisionAlignment"/>

		<!-- Exclude some WordPress sniffs that don't apply. -->
		<exclude name="WordPress.Files.FileName"/>
		<exclude name="WordPress.NamingConventions.ValidFunctionName"/>
		<exclude name="WordPress.NamingConventions.ValidHookName.UseUnderscores"/>
		<exclude name="WordPress.WP.AlternativeFunctions"/>

		<!--
		We rely on `.editorconfig` to remove trailing whitespace. This
		sniff just creates noise in the editor while coding.
		-->
		<exclude name="Squiz.WhiteSpace.SuperfluousWhitespace"/>

		<!-- Always allow short array syntax. -->
		<exclude name="Universal.Arrays.DisallowShortArraySyntax"/>
	</rule>

	<!--
	This creates too many false-positives when not actually overriding a
	global in pattern/partial files.
	-->
	<rule ref="WordPress.WP.GlobalVariablesOverride.Prohibited">
		<exclude-pattern>*/(patterns|resources\/partials)/*</exclude-pattern>
	</rule>

	<!-- Allow short echo tags but not short open tags. -->
	<rule ref="Generic.PHP.DisallowShortOpenTag.EchoFound">
		<severity>0</severity>
	</rule>

	<!-- Allow PHP calls to end without a semicolon for templating. -->
	<rule ref="Squiz.PHP.EmbeddedPhp.NoSemicolon">
		<severity>0</severity>
	</rule>
</ruleset>
